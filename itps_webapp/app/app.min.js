/**
 * Coded by idsilmat@gmail.com
 * 12.11.2020
 * v0.0.6
 **/
L.TileLayer.GWC=L.TileLayer.extend({_padZeros:function(a,e){for(padded=a.toString();padded.length<e;)padded="0"+padded;return padded},_formatZ:function(a){return a<10&&(a="0"+a),a},getTileUrl:function(a){return L.Util.template(this._url,L.extend({s:this._getSubdomain(a),z:this._formatZ(this._getZoomForUrl()),dir_x:this._padZeros(Math.floor(a.x/Math.pow(2,Math.floor(1+this._getZoomForUrl(a)/2))),Math.floor(this._getZoomForUrl(a)/6)+1),dir_y:this._padZeros(Math.floor(a.y/Math.pow(2,Math.floor(1+this._getZoomForUrl(a)/2))),Math.floor(this._getZoomForUrl(a)/6)+1),x:this._padZeros(a.x,2+2*Math.floor(this._getZoomForUrl(a)/6)),y:this._padZeros(a.y,2+2*Math.floor(this._getZoomForUrl(a)/6))},this.options))}});var LAYERS=[],coverage_type=null;const BAGRAS_GEOJSON="http://127.0.0.1/itps_webapp/data/RescaledRefinedBagras_CaragaRegion.json",MANGIUM_GEOJSON="http://127.0.0.1/itps_webapp/data/RescaledRefinedMangium_CaragaRegion.json",GMELINA_GEOJSON="http://127.0.0.1/itps_webapp/data/RescaledRefinedGmelina_CaragaRegion.json",FALCATA_GEOJSON="http://127.0.0.1/itps_webapp/data/RescaledRefinedFalcata_CaragaRegion.json",BRGY_FALCATA="http://127.0.0.1/itps_webapp/data/Falcata_Stats_BrgyLevel.json",BRGY_GMELINA="http://127.0.0.1/itps_webapp/data/Gmelina_Stats_BrgyLevel.json",BRGY_MANGIUM="http://127.0.0.1/itps_webapp/data/Mangium_Stats_BrgyLevel.json",BRGY_BAGRAS="http://127.0.0.1/itps_webapp/data/Bagras_Stats_BrgyLevel.json",MUN_FALCATA="http://127.0.0.1/itps_webapp/data/Falcata_Stats_MunLevel.json",MUN_GMELINA="http://127.0.0.1/itps_webapp/data/Gmelina_Stats_MunLevel.json",MUN_MANGIUM="http://127.0.0.1/itps_webapp/data/Mangium_Stats_MunLevel.json",MUN_BAGRAS="http://127.0.0.1/itps_webapp/data/Bagras_Stats_MunLevel.json",PROV_FALCATA="http://127.0.0.1/itps_webapp/data/Falcata_Stats_ProvLevel.json",PROV_GMELINA="http://127.0.0.1/itps_webapp/data/Gmelina_Stats_ProvLevel.json",PROV_MANGIUM="http://127.0.0.1/itps_webapp/data/Mangium_Stats_ProvLevel.json",PROV_BAGRAS="http://127.0.0.1/itps_webapp/data/Bagras_Stats_ProvLevel.json",CARAGA_PLACES="http://127.0.0.1/itps_webapp/js/caraga.json";var map=L.map("map");map.setView([9.1204,125.59],8);var FALCATAtileLayer,BAGRAStileLayer,MANGIUMtileLayer,GMELINAtileLayer,BRGYtileLayer,MUNtileLayer,PROVtileLayer,falcataRepoJSON,bagrasRepoJSON,mangiumRepoJSON,gmelinaRepoJSON,highlight,treesRepo=L.geoJson(null),brgyRepoFalcata=L.geoJson(null),brgyRepoFalcata1=null,brgyRepoGmelina=L.geoJson(null),brgyRepoGmelina1=null,brgyRepoMangium=L.geoJson(null),brgyRepoMangium1=null,brgyRepoBagras=L.geoJson(null),brgyRepoBagras1=null,munRepoFalcata=L.geoJson(null),munRepoFalcata1=null,munRepoGmelina=L.geoJson(null),munRepoGmelina1=null,munRepoMangium=L.geoJson(null),munRepoMangium1=null,munRepoBagras=L.geoJson(null),munRepoBagras1=null,provRepoFalcata=L.geoJson(null),provRepoFalcata1=null,provRepoGmelina=L.geoJson(null),provRepoGmelina1=null,provRepoMangium=L.geoJson(null),provRepoMangium1=null,provRepoBagras=L.geoJson(null),provRepoBagras1=null,groupAreaStats=new L.layerGroup,groupTrees=new L.layerGroup,FILTERED_LAYER=null,toogleFALCATA=!1,toogleBAGRAS=!1,toogleGMELINA=!1,toogleMANGIUM=!1,toogleAreaStats=!1,toogleAreaStatsByBrgy=!1,toogleAreaStatsByMun=!1,toogleAreaStatsByMProv=!1,activeStatsLayer=null,activeTreeName=null,loadedLayers=[],TREES_FILTER=null;function addFALCATA(){var a;if(0==toogleFALCATA){$("#loadMe").modal("show");var e=omnivore.topojson(FALCATA_GEOJSON);e.on("ready",function(){a=e.toGeoJSON(),treesRepo.addData(a),falcataRepoJSON=a,FALCATAtileLayer=L.vectorGrid.slicer(a,{rendererFactory:L.canvas.tile,vectorTileLayerStyles:{sliced:{fillColor:"skyblue",color:"blue",weight:.1,fill:!0,stroke:!0,fillOpacity:.8}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.id}}).addTo(map),toogleFALCATA=!0,groupTrees.addLayer(FALCATAtileLayer),setTimeout(function(){$("#loadMe").modal("hide")},500)})}}function addMANGIUM(){var a;if(0==toogleMANGIUM){$("#loadMe").modal("show");var e=omnivore.topojson(MANGIUM_GEOJSON);e.on("ready",function(){a=e.toGeoJSON(),mangiumRepoJSON=a,treesRepo.addData(a),MANGIUMtileLayer=L.vectorGrid.slicer(a,{rendererFactory:L.canvas.tile,vectorTileLayerStyles:{sliced:{fillColor:"orange",color:"orange",weight:.1,fill:!0,stroke:!0,fillOpacity:.8}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.id}}).addTo(map),setTimeout(function(){$("#loadMe").modal("hide")},500),groupTrees.addLayer(MANGIUMtileLayer),toogleMANGIUM=!0})}}function addGMELINA(){var a;if(0==toogleGMELINA){$("#loadMe").modal("show");var e=omnivore.topojson(GMELINA_GEOJSON);e.on("ready",function(){a=e.toGeoJSON(),gmelinaRepoJSON=a,treesRepo.addData(a),GMELINAtileLayer=L.vectorGrid.slicer(a,{rendererFactory:L.canvas.tile,vectorTileLayerStyles:{sliced:{fillColor:"red",color:"red",weight:.1,fill:!0,stroke:!0,fillOpacity:.8}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.id}}).addTo(map),groupTrees.addLayer(GMELINAtileLayer),setTimeout(function(){$("#loadMe").modal("hide")},500),toogleGMELINA=!0})}}function addBAGRAS(){var a;if(0==toogleBAGRAS){$("#loadMe").modal("show");var e=omnivore.topojson(BAGRAS_GEOJSON);e.on("ready",function(){a=e.toGeoJSON(),bagrasRepoJSON=a,treesRepo.addData(a),BAGRAStileLayer=L.vectorGrid.slicer(a,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:{fillColor:"green",color:"blue",weight:.1,fill:!0,stroke:!0,fillOpacity:.8}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.id}}).addTo(map),groupTrees.addLayer(BAGRAStileLayer),toogleBAGRAS=!0,setTimeout(function(){$("#loadMe").modal("hide")},500)})}}function addLayerStats(a,e,t){if(0==toogleAreaStats){var r;$("#loadMe").modal("show");var o=omnivore.topojson(a);o.on("ready",function(){r=o.toGeoJSON(),"Barangay"==e&&("Barangay_Falcata"==t&&(brgyRepoFalcata.addData(r),brgyRepoFalcata1=r),"Barangay_Gmelina"==t&&(brgyRepoGmelina.addData(r),brgyRepoGmelina1=r),"Barangay_Mangium"==t&&(brgyRepoMangium.addData(r),brgyRepoMangium1=r),"Barangay_Bagras"==t&&(brgyRepoBagras.addData(r),brgyRepoBagras1=r),BRGYtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.BGY_CODE+"_"+a.MUN_CODE},name:t}).addTo(map),groupAreaStats.addLayer(BRGYtileLayer),toogleAreaStatsByBrgy=!0),"City/Municipality"==e&&("City/Municipality_Falcata"==t&&(munRepoFalcata.addData(r),munRepoFalcata1=r),"City/Municipality_Gmelina"==t&&(munRepoGmelina.addData(r),munRepoGmelina1=r),"City/Municipality_Mangium"==t&&(munRepoMangium.addData(r),munRepoMangium1=r),"City/Municipality_Bagras"==t&&(munRepoBagras.addData(r),munRepoBagras1=r),MUNtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.MUN_CODE},name:t}).addTo(map),toogleAreaStatsByMun=!0,groupAreaStats.addLayer(MUNtileLayer)),"Province"==e&&("Province_Falcata"==t&&(provRepoFalcata.addData(r),provRepoFalcata1=r),"Province_Gmelina"==t&&(provRepoGmelina.addData(r),provRepoGmelina1=r),"Province_Mangium"==t&&(provRepoMangium.addData(r),provRepoMangium1=r),"Province_Bagras"==t&&(provRepoBagras.addData(r),provRepoBagras1=r),PROVtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.PRO_CODE},name:t}).addTo(map),toogleAreaStatsByMProv=!0,groupAreaStats.addLayer(PROVtileLayer)),toogleAreaStats=!0,coverage_type=e,setTimeout(function(){$("#loadMe").modal("hide")},500)})}}function loadLayerStats(a,e,t){var r=null;"Barangay"==e&&("Barangay_Falcata"==t&&(r=brgyRepoFalcata1),"Barangay_Gmelina"==t&&(r=brgyRepoGmelina1),"Barangay_Mangium"==t&&(r=brgyRepoMangium1),"Barangay_Bagras"==t&&(r=brgyRepoBagras1),BRGYtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.BGY_CODE+"_"+a.MUN_CODE},name:t}),map.addLayer(BRGYtileLayer),toogleAreaStatsByBrgy=!0),"City/Municipality"==e&&("City/Municipality_Falcata"==t&&(r=munRepoFalcata1),"City/Municipality_Gmelina"==t&&(r=munRepoGmelina1),"City/Municipality_Mangium"==t&&(r=munRepoMangium1),"City/Municipality_Bagras"==t&&(r=munRepoBagras1),MUNtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.MUN_CODE},name:t}),map.addLayer(MUNtileLayer),toogleAreaStatsByMun=!0),"Province"==e&&("Province_Falcata"==t&&(r=provRepoFalcata1),"Province_Gmelina"==t&&(r=provRepoGmelina1),"Province_Mangium"==t&&(r=provRepoMangium1),"Province_Bagras"==t&&(r=provRepoBagras1),PROVtileLayer=L.vectorGrid.slicer(r,{rendererFactory:L.canvas.tile,loadingControl:!0,vectorTileLayerStyles:{sliced:function(a,e){var t=a.Area_sqm;return 0==t?{fillColor:"white",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t<=2e4?{fillColor:"yellow",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:t>2e4&&t<=4e4?{fillColor:"orange",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}:{fillColor:"red",color:"black",weight:1,fill:!0,stroke:!0,fillOpacity:.8}}},maxZoom:22,indexMaxZoom:5,interactive:!0,getFeatureId:function(a){return a.PRO_CODE},name:t}),map.addLayer(PROVtileLayer),toogleAreaStatsByMProv=!0)}function loadDoc(){var a=[];return $.getJSON(CARAGA_PLACES,function(e){var t=e.province_list;$.each(t,function(e,t){var r=e,o=t;$.each(o,function(e,t){var o=t;$.each(o,function(e,t){for(var o=e,l=t.barangay_list,i=0;i<l.length;i++)a.push(l[i]+", "+o+", "+r)})})})}),a}$(document).ready(function(){var a,e=loadDoc();$("#the-basics .typeahead").typeahead({hint:!0,highlight:!0,minLength:1},{name:"barangays",source:(a=e,function(e,t){var r;r=[],substrRegex=new RegExp(e,"i"),$.each(a,function(a,e){substrRegex.test(e)&&r.push(e)}),t(r)})});var t=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:"Map data &copy; OpenStreetMap contributors",name:"Open Street Map",zIndex:0}),r=L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],attribution:"Map data &copy; Google",name:"Google Sattelite",zIndex:0}),o=L.tileLayer("http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],attribution:"Map data &copy; Google",name:"Google Hybrid",zIndex:0}).addTo(map),l=L.Control.loading({position:"topleft",separate:!0});map.addControl(l),L.control({position:"topright"}).onAdd=function(a){var e=L.DomUtil.create("div","maplegend");return e.innerHTML+="<h4>Trees</h4>",e.innerHTML+='<i style="background: skyblue"></i><span>Falcata</span><br>',e.innerHTML+='<i style="background: green"></i><span>Bagras</span><br>',e.innerHTML+='<i style="background: red"></i><span>Gmelina</span><br>',e.innerHTML+='<i style="background: orange"></i><span>Mangium</span><br>',e};var i=L.control.sidebar({container:"sidebar"}).addTo(map).open("home");i.on("content",function(a){switch(a.id){case"autopan":i.options.autopan=!0;break;default:i.options.autopan=!1}}),$("select#layers").treeMultiselect({allowBatchSelection:!1,showSectionOnSelected:!1,onChange:function(a,e,t){map.hasLayer(FILTERED_LAYER)&&map.removeLayer(FILTERED_LAYER);var r=null,o=null,l=null,i=null,n=null;if(t.length>0&&(i=t[0].value,n=t[0].text),e.length>0&&(loadedLayers.includes(e[0])||loadedLayers.push(e[0]),r=e[0].value,o=e[0].text,l=e[0].section.split("/")),"trees"===r){var p=LAYERS.indexOf("stats");LAYERS.splice(p,1);for(var s=0;s<loadedLayers.length;s++){if("trees"!=loadedLayers[s].value)(y=loadedLayers[s].node).getElementsByTagName("input")[0].checked=!1,$('.item[data-key="'+loadedLayers[s].id+'"] span.remove-selected').click()}groupAreaStats.hasLayer(BRGYtileLayer)&&map.removeLayer(BRGYtileLayer),groupAreaStats.hasLayer(MUNtileLayer)&&map.removeLayer(MUNtileLayer),groupAreaStats.hasLayer(PROVtileLayer)&&map.removeLayer(PROVtileLayer),TREES_FILTER=o,"Bagras"===o&&0==toogleBAGRAS&&addBAGRAS(),"Bagras"===o&&1==toogleBAGRAS&&map.addLayer(BAGRAStileLayer),"Falcata"===o&&0==toogleFALCATA&&addFALCATA(),"Falcata"===o&&1==toogleFALCATA&&map.addLayer(FALCATAtileLayer),"Gmelina"===o&&0==toogleGMELINA&&addGMELINA(),"Gmelina"===o&&1==toogleGMELINA&&map.addLayer(GMELINAtileLayer),"Mangium"===o&&0==toogleMANGIUM&&addMANGIUM(),"Mangium"===o&&1==toogleMANGIUM&&map.addLayer(MANGIUMtileLayer),LAYERS.includes(o+"_trees")||LAYERS.push(o+"_trees")}if("stats"===r){for(s=0;s<loadedLayers.length;s++){var y=loadedLayers[s].node;loadedLayers[s].id!=e[0].id?(y.getElementsByTagName("input")[0].checked=!1,$('.item[data-key="'+loadedLayers[s].id+'"] span.remove-selected').click()):y.getElementsByTagName("input")[0].checked=!0}groupAreaStats.hasLayer(BRGYtileLayer)&&map.removeLayer(BRGYtileLayer),groupAreaStats.hasLayer(MUNtileLayer)&&map.removeLayer(MUNtileLayer),groupAreaStats.hasLayer(PROVtileLayer)&&map.removeLayer(PROVtileLayer),groupTrees.hasLayer(FALCATAtileLayer)&&map.removeLayer(FALCATAtileLayer),groupTrees.hasLayer(GMELINAtileLayer)&&map.removeLayer(GMELINAtileLayer),groupTrees.hasLayer(MANGIUMtileLayer)&&map.removeLayer(MANGIUMtileLayer),groupTrees.hasLayer(BAGRAStileLayer)&&map.removeLayer(BAGRAStileLayer),-1==(p=LAYERS.indexOf("stats"))&&LAYERS.push("stats");var c=null,g=o+"_"+l[2],L=l[2];null==activeStatsLayer&&(activeStatsLayer=g),null==activeTreeName&&(activeTreeName="Nothing"),"Barangay_Falcata"==g&&(c=BRGY_FALCATA),"Barangay_Gmelina"==g&&(c=BRGY_GMELINA),"Barangay_Mangium"==g&&(c=BRGY_MANGIUM),"Barangay_Bagras"==g&&(c=BRGY_BAGRAS),"City/Municipality_Falcata"==g&&(c=MUN_FALCATA),"City/Municipality_Gmelina"==g&&(c=MUN_GMELINA),"City/Municipality_Mangium"==g&&(c=MUN_MANGIUM),"City/Municipality_Bagras"==g&&(c=MUN_BAGRAS),"Province_Falcata"==g&&(c=PROV_FALCATA),"Province_Gmelina"==g&&(c=PROV_GMELINA),"Province_Mangium"==g&&(c=PROV_MANGIUM),"Province_Bagras"==g&&(c=PROV_BAGRAS),TREES_FILTER=g,coverage_type==o&&g==activeStatsLayer||LAYERS.includes(g)||(toogleAreaStats=!1),g==activeStatsLayer||L==activeTreeName||LAYERS.includes(g)||(toogleAreaStatsByBrgy=!1,toogleAreaStatsByMun=!1,toogleAreaStatsByMProv=!1),LAYERS.includes(g)||LAYERS.push(g),activeStatsLayer=g,activeTreeName=L,0==toogleAreaStats&&"Barangay"==o&&0==toogleAreaStatsByBrgy&&addLayerStats(c,o,g),1==toogleAreaStatsByBrgy&&LAYERS.includes(g)&&"Barangay"==o&&loadLayerStats(c,o,g),0==toogleAreaStats&&"City/Municipality"==o&&0==toogleAreaStatsByMun&&addLayerStats(c,o,g),1==toogleAreaStatsByMun&&LAYERS.includes(g)&&"City/Municipality"==o&&loadLayerStats(c,o,g),0==toogleAreaStats&&"Province"==o&&0==toogleAreaStatsByMProv&&addLayerStats(c,o,g),1==toogleAreaStatsByMProv&&LAYERS.includes(g)&&"Province"==o&&loadLayerStats(c,o,g)}"Falcata"===n&&groupTrees.hasLayer(FALCATAtileLayer)&&map.removeLayer(FALCATAtileLayer),"Bagras"===n&&groupTrees.hasLayer(BAGRAStileLayer)&&map.removeLayer(BAGRAStileLayer),"Gmelina"===n&&groupTrees.hasLayer(GMELINAtileLayer)&&map.removeLayer(GMELINAtileLayer),"Mangium"===n&&groupTrees.hasLayer(MANGIUMtileLayer)&&map.removeLayer(MANGIUMtileLayer),"stats"===i&&("Barangay"==n&&map.removeLayer(BRGYtileLayer),"City/Municipality"==n&&map.removeLayer(MUNtileLayer),"Province"==n&&map.removeLayer(PROVtileLayer))},startCollapsed:!0}),$("#base_map").multiselect({multiple:!1,onChange:function(a,e,l){var i=$(a).val();"osm"==i?(map.removeLayer(r),map.removeLayer(o),map.addLayer(t)):"googleHybrid"==i?(map.addLayer(o),map.removeLayer(r),map.removeLayer(t)):(map.addLayer(r),map.removeLayer(t),map.removeLayer(o))}}),$("#trees").val("").multiselect({multiple:!1,nonSelectedText:"Select Tree",onChange:function(a,e,t){map.hasLayer(FILTERED_LAYER)&&map.removeLayer(FILTERED_LAYER);var r=$(a).val();if(TREES_FILTER=r,e){for(var o=0;o<loadedLayers.length;o++){loadedLayers[o].node.getElementsByTagName("input")[0].checked=!1,$('.item[data-key="'+loadedLayers[o].id+'"] span.remove-selected').click()}var l=LAYERS.indexOf("stats");LAYERS.splice(l,1),groupAreaStats.hasLayer(BRGYtileLayer)&&map.removeLayer(BRGYtileLayer),groupAreaStats.hasLayer(MUNtileLayer)&&map.removeLayer(MUNtileLayer),groupAreaStats.hasLayer(PROVtileLayer)&&map.removeLayer(PROVtileLayer),groupTrees.hasLayer(FALCATAtileLayer)&&map.removeLayer(FALCATAtileLayer),groupTrees.hasLayer(GMELINAtileLayer)&&map.removeLayer(GMELINAtileLayer),groupTrees.hasLayer(MANGIUMtileLayer)&&map.removeLayer(MANGIUMtileLayer),groupTrees.hasLayer(BAGRAStileLayer)&&map.removeLayer(BAGRAStileLayer),"Bagras"===r&&0==toogleBAGRAS&&addBAGRAS(),"Bagras"===r&&1==toogleBAGRAS&&map.addLayer(BAGRAStileLayer),"Falcata"===r&&0==toogleFALCATA&&addFALCATA(),"Falcata"===r&&1==toogleFALCATA&&map.addLayer(FALCATAtileLayer),"Gmelina"===r&&0==toogleGMELINA&&addGMELINA(),"Gmelina"===r&&1==toogleGMELINA&&map.addLayer(GMELINAtileLayer),"Mangium"===r&&0==toogleMANGIUM&&addMANGIUM(),"Mangium"===r&&1==toogleMANGIUM&&map.addLayer(MANGIUMtileLayer)}}});var n=document.getElementById("myChart"),p=new Chart(n,{type:"bar",data:{labels:[],datasets:[{label:"Area in sq. m.",data:[],backgroundColor:[]}]},options:{legend:{labels:{boxWidth:0}},title:{display:!0,text:""},scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}});map.on("click",function(a){highlight&&map.removeLayer(highlight);var e=a.latlng.lng,t=a.latlng.lat,r=leafletPip.pointInLayer([e,t],treesRepo,!0),o=null,l=activeStatsLayer;if("Barangay_Falcata"==l&&(o=leafletPip.pointInLayer([e,t],brgyRepoFalcata,!0)),"Barangay_Gmelina"==l&&(o=leafletPip.pointInLayer([e,t],brgyRepoGmelina,!0)),"Barangay_Mangium"==l&&(o=leafletPip.pointInLayer([e,t],brgyRepoMangium,!0)),"Barangay_Bagras"==l&&(o=leafletPip.pointInLayer([e,t],brgyRepoBagras,!0)),"City/Municipality_Falcata"==l&&(o=leafletPip.pointInLayer([e,t],munRepoFalcata,!0)),"City/Municipality_Gmelina"==l&&(o=leafletPip.pointInLayer([e,t],munRepoGmelina,!0)),"City/Municipality_Mangium"==l&&(o=leafletPip.pointInLayer([e,t],munRepoMangium,!0)),"City/Municipality_Bagras"==l&&(o=leafletPip.pointInLayer([e,t],munRepoBagras,!0)),"Province_Falcata"==l&&(o=leafletPip.pointInLayer([e,t],provRepoFalcata,!0)),"Province_Gmelina"==l&&(o=leafletPip.pointInLayer([e,t],provRepoGmelina,!0)),"Province_Mangium"==l&&(o=leafletPip.pointInLayer([e,t],provRepoMangium,!0)),"Province_Bagras"==l&&(o=leafletPip.pointInLayer([e,t],provRepoBagras,!0)),r[0]&&0==LAYERS.includes("stats")){var i=r[0].feature.properties,n=r[0].feature;highlight=new L.geoJson(n,{style:{color:"deepskyblue",fillColor:"deepskyblue"}});var s="<strong>Species:</strong> "+i.Species+"</br><strong>Location:</strong> "+i.Bgy_Name+", "+i.Mun_Name+", "+i.Pro_Name+", "+i.Reg_Name+"</br><strong>Area in square meters:</strong>"+i.Area_sqm.toFixed(2);map.on("popupclose",function(){map.removeLayer(highlight)}),setTimeout(function(){highlight.addTo(map),map.openPopup(s,a.latlng)},50)}if(o[0]&&LAYERS.includes("stats")){o[0].feature.id;var y="";y=(i=o[0].feature.properties).Bgy_Name?i.Bgy_Name+", "+i.Mun_Name+", "+i.Pro_Name:i.Mun_Name?i.Mun_Name+", "+i.Pro_Name:i.Pro_Name;n=o[0].feature;highlight=new L.geoJson(n,{style:{color:"white",fillColor:"white"}});var c=[i.Area_sqm.toFixed(2)];p.data.datasets[0].data=c,p.data.datasets[0].backgroundColor="grey",p.data.labels[0]=i.Species,p.options.title.text=y,p.update(),setTimeout(function(){highlight.addTo(map),$("#chartMe").modal("show")},50),$("#chartMe").on("hidden.bs.modal",function(a){map.removeLayer(highlight)})}}),$("#citymun").remoteChained({parents:"#prov",url:CARAGA_PLACES,data:function(a){var e=$("#prov").val(),t=a.province_list[e].municipality_list,r=[];return $.each(t,function(a){var e={};e[a]=a,r.push(e)}),r}}),$("#brgy").remoteChained({parents:"#citymun, #prov",url:CARAGA_PLACES,data:function(a){var e=$("#prov").val(),t=$("#citymun").val(),r=a.province_list[e].municipality_list[t].barangay_list,o=[];return r.forEach(a=>{var e={};e[a]=a,o.push(e)}),o}}),$("#btnOK").click(function(){i.open("query")}),$("#searchBarangay").focus(function(){$("#the-basics .typeahead").typeahead("val","")}),$("#btnSearchBrgy").click(function(){map.hasLayer(FILTERED_LAYER)&&map.removeLayer(FILTERED_LAYER);var a=$("#searchBarangay").val().split(","),e="All",t=null;"Falcata"==TREES_FILTER&&(t=falcataRepoJSON),"Mangium"==TREES_FILTER&&(t=mangiumRepoJSON),"Gmelina"==TREES_FILTER&&(t=gmelinaRepoJSON),"Bagras"==TREES_FILTER&&(t=bagrasRepoJSON),"Barangay_Falcata"==TREES_FILTER&&(t=brgyRepoFalcata1),"Barangay_Gmelina"==TREES_FILTER&&(t=brgyRepoGmelina1),"Barangay_Mangium"==TREES_FILTER&&(t=brgyRepoMangium1),"Barangay_Bagras"==TREES_FILTER&&(t=brgyRepoBagras1),"City/Municipality_Falcata"==TREES_FILTER&&(t=munRepoFalcata1,e="Municipal"),"City/Municipality_Gmelina"==TREES_FILTER&&(t=munRepoGmelina1,e="Municipal"),"City/Municipality_Mangium"==TREES_FILTER&&(t=munRepoMangium1,e="Municipal"),"City/Municipality_Bagras"==TREES_FILTER&&(t=munRepoBagras1,e="Municipal"),"Province_Falcata"==TREES_FILTER&&(t=provRepoFalcata1,e="Provincial"),"Province_Gmelina"==TREES_FILTER&&(t=provRepoGmelina1,e="Provincial"),"Province_Mangium"==TREES_FILTER&&(t=provRepoMangium1,e="Provincial"),"Province_Bagras"==TREES_FILTER&&(t=provRepoBagras1,e="Provincial"),FILTERED_LAYER=L.geoJson(t,{style:{fillColor:"#EE82EE",color:"white",weight:.1,fill:!0,stroke:!0,fillOpacity:.8},filter:function(t){return"All"==e?t.properties.Bgy_Name==a[0]&&t.properties.Mun_Name==a[1].trim()&&t.properties.Pro_Name==a[2].trim():"Municipal"==e?t.properties.Mun_Name==a[1].trim()&&t.properties.Pro_Name==a[2].trim():t.properties.Pro_Name==a[2].trim()}}).addTo(map),null==t?alert("YOU HAVE NOT SELECTED/LOADED A LAYER!"):FILTERED_LAYER.getLayers().length>0?map.fitBounds(FILTERED_LAYER.getBounds()):alert("NO RESULT FOUND, TRY ANOTHER LOCATION!")}),$("#btnGo").click(function(){map.hasLayer(FILTERED_LAYER)&&map.removeLayer(FILTERED_LAYER);var a=$("#brgy").val(),e=$("#citymun").val(),t=$("#prov").val(),r=null;"Falcata"==TREES_FILTER&&(r=falcataRepoJSON),"Mangium"==TREES_FILTER&&(r=mangiumRepoJSON),"Gmelina"==TREES_FILTER&&(r=gmelinaRepoJSON),"Bagras"==TREES_FILTER&&(r=bagrasRepoJSON),(FILTERED_LAYER=L.geoJson(r,{style:{fillColor:"orange",color:"white",weight:.1,fill:!0,stroke:!0,fillOpacity:.8},filter:function(r,o){return r.properties.Bgy_Name==a&&r.properties.Mun_Name==e&&r.properties.Pro_Name==t}}).addTo(map)).getLayers().length>0?map.fitBounds(FILTERED_LAYER.getBounds()):alert("NO RESULT FOUND, TRY ANOTHER LOCATION!")}),$("#btnClear").click(function(){map.hasLayer(FILTERED_LAYER)&&map.removeLayer(FILTERED_LAYER)})});